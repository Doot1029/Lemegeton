{
    "sourceFile": "map.patch",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 6,
            "patches": [
                {
                    "date": 1772084580166,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1772084753748,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -172,9 +172,8 @@\n +          return result;\r\n          }\r\n -    ]\r\n -}\r\n-\\ No newline at end of file\r\n +      });\r\n +    }\r\n +\r\n +    engine.state.flags.commandAnimationTemplateInstalled = true;\r\n"
                },
                {
                    "date": 1772084763339,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,233 +0,0 @@\n-diff --git a/node_modules/lorejs/games/lemegeton.js b/node_modules/lorejs/games/lemegeton.js\r\n-index fe3b5a0a2991aa6b3a2e25fb2c6e5d05776b11cf..eb28f82210bda0a35415dcf506f6d6aa73bd050e 100644\r\n---- a/node_modules/lorejs/games/lemegeton.js\r\n-+++ b/node_modules/lorejs/games/lemegeton.js\r\n-@@ -1,36 +1,194 @@\r\n--let state = {\r\n--    day: 1,\r\n--    weekday: \"saturn\",\r\n--    hour: \"saturn\"\r\n--};\r\n-+const IDLE_ANIMATIONS = [\r\n-+  [\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\   \\ \r\n-+      ''  ''`,\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\   \\ \r\n-+      ''  ''`,\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\  / \r\n-+      ''  ''`\r\n-+  ],\r\n-+  [\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ (    ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`,\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ ( .. ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`,\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ ( oo ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`\r\n-+  ]\r\n-+];\r\n- \r\n--module.exports = {\r\n--    title: \"Lemegeton: The Journey to Apotheosis\",\r\n--    startRoom: \"cottage\",\r\n--    rooms: [\r\n--        {\r\n--            id: \"cottage\",\r\n--            name: \"Your Mother's Cottage\",\r\n--            description: \"Your mother's cottage is quite cozy.\",\r\n--            exits: {\r\n--                garden: \"garden\"\r\n--            },\r\n--            characters: [\"mother\"]\r\n--        },\r\n--        {\r\n--            id: \"garden\",\r\n--            name: \"The Garden\",\r\n--            description: \"A garden near mother's cottage, smells like flowers and berries.\"\r\n--        }\r\n--    ],\r\n--    characters: [\r\n--        {\r\n--            id: \"mother\",\r\n--            name: \"Loving Mother\",\r\n--            description: \"A kind and religious woman who cares deeply for her twins, Deo and Dominique.\",\r\n--            talk: (state, engine) => {\r\n--                engine.printLine(\"Mother: 'Be careful in the garden, children. Stay where I can see you.'\");\r\n--            }\r\n-+const ACTION_ANIMATIONS = [\r\n-+  [\r\n-+    String.raw`  /\\\r\n-+ /  \\\\\r\n-+| !! |\r\n-+ \\  /\r\n-+  \\/`,\r\n-+    String.raw`  /\\\\\r\n-+ / !!\\\\\r\n-+| !!!!|\r\n-+ \\ !!/\r\n-+  \\\\/`,\r\n-+    String.raw`  /\\\r\n-+ / **\\\\\r\n-+| ****|\r\n-+ \\ **/\r\n-+  \\/`\r\n-+  ],\r\n-+  [\r\n-+    String.raw`[>      ]`,\r\n-+    String.raw`[>>     ]`,\r\n-+    String.raw`[ >>>   ]`,\r\n-+    String.raw`[  >>>> ]`\r\n-+  ]\r\n-+];\r\n-+\r\n-+function createCommandAnimationTemplate({\r\n-+  idleAnimations,\r\n-+  actionAnimations,\r\n-+  excludedCommands = ['look'],\r\n-+  actionCommands = ['go', 'move', 'take', 'drop', 'use', 'talk', 'say', 'north', 'south', 'east', 'west', 'n', 's', 'e', 'w']\r\n-+}) {\r\n-+  const excluded = new Set(excludedCommands.map((cmd) => cmd.toLowerCase()));\r\n-+  const action = new Set(actionCommands.map((cmd) => cmd.toLowerCase()));\r\n-+\r\n-+  function initAnimationState(engine) {\r\n-+    if (!engine.state.variables.__animationTemplate) {\r\n-+      engine.state.variables.__animationTemplate = {\r\n-+        idleIndex: 0,\r\n-+        actionIndex: 0\r\n-+      };\r\n-+    }\r\n-+    return engine.state.variables.__animationTemplate;\r\n-+  }\r\n-+\r\n-+  function getMode(commandName) {\r\n-+    return action.has(commandName) ? 'action' : 'idle';\r\n-+  }\r\n-+\r\n-+  function nextAnimation(engine, mode) {\r\n-+    const templateState = initAnimationState(engine);\r\n-+    if (mode === 'action') {\r\n-+      const frame = actionAnimations[templateState.actionIndex % actionAnimations.length];\r\n-+      templateState.actionIndex += 1;\r\n-+      return frame;\r\n-+    }\r\n-+\r\n-+    const frame = idleAnimations[templateState.idleIndex % idleAnimations.length];\r\n-+    templateState.idleIndex += 1;\r\n-+    return frame;\r\n-+  }\r\n-+\r\n-+  function play(engine, commandName) {\r\n-+    if (excluded.has(commandName)) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    const mode = getMode(commandName);\r\n-+    const animationFrames = nextAnimation(engine, mode);\r\n-+\r\n-+    if (!animationFrames || !animationFrames.length) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    engine.stopAllAnimations();\r\n-+    engine.printImg(animationFrames);\r\n-+    engine.printLine(`{{cyan}}[${mode.toUpperCase()} ANIMATION]{{color_reset}}`, true);\r\n-+  }\r\n-+\r\n-+  function install(engine) {\r\n-+    if (engine.state.flags.commandAnimationTemplateInstalled) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    for (const [commandName, commandConfig] of engine.world.commands) {\r\n-+      const originalFn = commandConfig.fn;\r\n-+      engine.world.commands.set(commandName, {\r\n-+        ...commandConfig,\r\n-+        fn(args, activeEngine) {\r\n-+          const result = originalFn.call(this, args, activeEngine);\r\n-+          play(activeEngine, commandName);\r\n-+          return result;\r\n-         }\r\n--    ]\r\n--}\r\n-+      });\r\n-+    }\r\n-+\r\n-+    engine.state.flags.commandAnimationTemplateInstalled = true;\r\n-+  }\r\n-+\r\n-+  return {\r\n-+    install,\r\n-+    play,\r\n-+    nextAnimation,\r\n-+    getMode\r\n-+  };\r\n-+}\r\n-+\r\n-+const commandAnimationTemplate = createCommandAnimationTemplate({\r\n-+  idleAnimations: IDLE_ANIMATIONS,\r\n-+  actionAnimations: ACTION_ANIMATIONS,\r\n-+  excludedCommands: ['look']\r\n-+});\r\n-+\r\n-+module.exports = {\r\n-+  title: 'Lemegeton: Animation Template Demo',\r\n-+  startRoom: 'atrium',\r\n-+  rooms: [\r\n-+    {\r\n-+      id: 'atrium',\r\n-+      name: '{{bold}}Atrium{{font_reset}}',\r\n-+      description: 'A ritual atrium filled with humming glyphs. Try commands like {{yellow}}help{{color_reset}}, {{yellow}}go north{{color_reset}}, {{yellow}}take sigil{{color_reset}}, and {{yellow}}look{{color_reset}} to preview the animation template behavior.',\r\n-+      exits: {\r\n-+        north: 'sanctum'\r\n-+      },\r\n-+      items: ['sigil'],\r\n-+      onEnter: (state, engine) => {\r\n-+        commandAnimationTemplate.install(engine);\r\n-+      }\r\n-+    },\r\n-+    {\r\n-+      id: 'sanctum',\r\n-+      name: '{{bold}}Sanctum{{font_reset}}',\r\n-+      description: 'A quiet sanctum where idle effects continue between actions.',\r\n-+      exits: {\r\n-+        south: 'atrium'\r\n-+      }\r\n-+    }\r\n-+  ],\r\n-+  items: [\r\n-+    {\r\n-+      id: 'sigil',\r\n-+      name: 'metal sigil seal',\r\n-+      takeable: true,\r\n-+      description: 'A metal sigil that pulses whenever action animations trigger.',\r\n-+      use: (state, engine) => {\r\n-+        engine.printLine('The sigil resonates with your command flow.');\r\n-+        return true;\r\n-+      }\r\n-+    }\r\n-+  ]\r\n-+};\n\\ No newline at end of file\n"
                },
                {
                    "date": 1772084775402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,238 @@\n+ (cd \"$(git rev-parse --show-toplevel)\" && git apply --3way <<'EOF' \r\n+diff --git a/node_modules/lorejs/games/lemegeton.js b/node_modules/lorejs/games/lemegeton.js\r\n+index fe3b5a0a2991aa6b3a2e25fb2c6e5d05776b11cf..eb28f82210bda0a35415dcf506f6d6aa73bd050e 100644\r\n+--- a/node_modules/lorejs/games/lemegeton.js\r\n++++ b/node_modules/lorejs/games/lemegeton.js\r\n+@@ -1,36 +1,194 @@\r\n+-let state = {\r\n+-    day: 1,\r\n+-    weekday: \"saturn\",\r\n+-    hour: \"saturn\"\r\n+-};\r\n++const IDLE_ANIMATIONS = [\r\n++  [\r\n++    String.raw`   .-.\r\n++  (o o)\r\n++  | O \\\r\n++   \\   \\\r\n++    \\\\   \\ \r\n++     \\\\   \\ \r\n++      ''  ''`,\r\n++    String.raw`   .-.\r\n++  (o o)\r\n++  | O \\\r\n++   \\   \\\r\n++    \\\\   \\ \r\n++     \\\\   \\ \r\n++      ''  ''`,\r\n++    String.raw`   .-.\r\n++  (o o)\r\n++  | O \\\r\n++   \\   \\\r\n++    \\\\   \\ \r\n++     \\\\  / \r\n++      ''  ''`\r\n++  ],\r\n++  [\r\n++    String.raw` ~~~~~~~~\r\n++~  .--.  ~\r\n++~ (    ) ~\r\n++~  '--'  ~\r\n++ ~~~~~~~~`,\r\n++    String.raw` ~~~~~~~~\r\n++~  .--.  ~\r\n++~ ( .. ) ~\r\n++~  '--'  ~\r\n++ ~~~~~~~~`,\r\n++    String.raw` ~~~~~~~~\r\n++~  .--.  ~\r\n++~ ( oo ) ~\r\n++~  '--'  ~\r\n++ ~~~~~~~~`\r\n++  ]\r\n++];\r\n+ \r\n+-module.exports = {\r\n+-    title: \"Lemegeton: The Journey to Apotheosis\",\r\n+-    startRoom: \"cottage\",\r\n+-    rooms: [\r\n+-        {\r\n+-            id: \"cottage\",\r\n+-            name: \"Your Mother's Cottage\",\r\n+-            description: \"Your mother's cottage is quite cozy.\",\r\n+-            exits: {\r\n+-                garden: \"garden\"\r\n+-            },\r\n+-            characters: [\"mother\"]\r\n+-        },\r\n+-        {\r\n+-            id: \"garden\",\r\n+-            name: \"The Garden\",\r\n+-            description: \"A garden near mother's cottage, smells like flowers and berries.\"\r\n+-        }\r\n+-    ],\r\n+-    characters: [\r\n+-        {\r\n+-            id: \"mother\",\r\n+-            name: \"Loving Mother\",\r\n+-            description: \"A kind and religious woman who cares deeply for her twins, Deo and Dominique.\",\r\n+-            talk: (state, engine) => {\r\n+-                engine.printLine(\"Mother: 'Be careful in the garden, children. Stay where I can see you.'\");\r\n+-            }\r\n++const ACTION_ANIMATIONS = [\r\n++  [\r\n++    String.raw`  /\\\r\n++ /  \\\\\r\n++| !! |\r\n++ \\  /\r\n++  \\/`,\r\n++    String.raw`  /\\\\\r\n++ / !!\\\\\r\n++| !!!!|\r\n++ \\ !!/\r\n++  \\\\/`,\r\n++    String.raw`  /\\\r\n++ / **\\\\\r\n++| ****|\r\n++ \\ **/\r\n++  \\/`\r\n++  ],\r\n++  [\r\n++    String.raw`[>      ]`,\r\n++    String.raw`[>>     ]`,\r\n++    String.raw`[ >>>   ]`,\r\n++    String.raw`[  >>>> ]`\r\n++  ]\r\n++];\r\n++\r\n++function createCommandAnimationTemplate({\r\n++  idleAnimations,\r\n++  actionAnimations,\r\n++  excludedCommands = ['look'],\r\n++  actionCommands = ['go', 'move', 'take', 'drop', 'use', 'talk', 'say', 'north', 'south', 'east', 'west', 'n', 's', 'e', 'w']\r\n++}) {\r\n++  const excluded = new Set(excludedCommands.map((cmd) => cmd.toLowerCase()));\r\n++  const action = new Set(actionCommands.map((cmd) => cmd.toLowerCase()));\r\n++\r\n++  function initAnimationState(engine) {\r\n++    if (!engine.state.variables.__animationTemplate) {\r\n++      engine.state.variables.__animationTemplate = {\r\n++        idleIndex: 0,\r\n++        actionIndex: 0\r\n++      };\r\n++    }\r\n++    return engine.state.variables.__animationTemplate;\r\n++  }\r\n++\r\n++  function getMode(commandName) {\r\n++    return action.has(commandName) ? 'action' : 'idle';\r\n++  }\r\n++\r\n++  function nextAnimation(engine, mode) {\r\n++    const templateState = initAnimationState(engine);\r\n++    if (mode === 'action') {\r\n++      const frame = actionAnimations[templateState.actionIndex % actionAnimations.length];\r\n++      templateState.actionIndex += 1;\r\n++      return frame;\r\n++    }\r\n++\r\n++    const frame = idleAnimations[templateState.idleIndex % idleAnimations.length];\r\n++    templateState.idleIndex += 1;\r\n++    return frame;\r\n++  }\r\n++\r\n++  function play(engine, commandName) {\r\n++    if (excluded.has(commandName)) {\r\n++      return;\r\n++    }\r\n++\r\n++    const mode = getMode(commandName);\r\n++    const animationFrames = nextAnimation(engine, mode);\r\n++\r\n++    if (!animationFrames || !animationFrames.length) {\r\n++      return;\r\n++    }\r\n++\r\n++    engine.stopAllAnimations();\r\n++    engine.printImg(animationFrames);\r\n++    engine.printLine(`{{cyan}}[${mode.toUpperCase()} ANIMATION]{{color_reset}}`, true);\r\n++  }\r\n++\r\n++  function install(engine) {\r\n++    if (engine.state.flags.commandAnimationTemplateInstalled) {\r\n++      return;\r\n++    }\r\n++\r\n++    for (const [commandName, commandConfig] of engine.world.commands) {\r\n++      const originalFn = commandConfig.fn;\r\n++      engine.world.commands.set(commandName, {\r\n++        ...commandConfig,\r\n++        fn(args, activeEngine) {\r\n++          const result = originalFn.call(this, args, activeEngine);\r\n++          play(activeEngine, commandName);\r\n++          return result;\r\n+         }\r\n+-    ]\r\n+-}\r\n+\\ No newline at end of file\r\n++      });\r\n++    }\r\n++\r\n++    engine.state.flags.commandAnimationTemplateInstalled = true;\r\n++  }\r\n++\r\n++  return {\r\n++    install,\r\n++    play,\r\n++    nextAnimation,\r\n++    getMode\r\n++  };\r\n++}\r\n++\r\n++const commandAnimationTemplate = createCommandAnimationTemplate({\r\n++  idleAnimations: IDLE_ANIMATIONS,\r\n++  actionAnimations: ACTION_ANIMATIONS,\r\n++  excludedCommands: ['look']\r\n++});\r\n++\r\n++module.exports = {\r\n++  title: 'Lemegeton: Animation Template Demo',\r\n++  startRoom: 'atrium',\r\n++  rooms: [\r\n++    {\r\n++      id: 'atrium',\r\n++      name: '{{bold}}Atrium{{font_reset}}',\r\n++      description: 'A ritual atrium filled with humming glyphs. Try commands like {{yellow}}help{{color_reset}}, {{yellow}}go north{{color_reset}}, {{yellow}}take sigil{{color_reset}}, and {{yellow}}look{{color_reset}} to preview the animation template behavior.',\r\n++      exits: {\r\n++        north: 'sanctum'\r\n++      },\r\n++      items: ['sigil'],\r\n++      onEnter: (state, engine) => {\r\n++        commandAnimationTemplate.install(engine);\r\n++      }\r\n++    },\r\n++    {\r\n++      id: 'sanctum',\r\n++      name: '{{bold}}Sanctum{{font_reset}}',\r\n++      description: 'A quiet sanctum where idle effects continue between actions.',\r\n++      exits: {\r\n++        south: 'atrium'\r\n++      }\r\n++    }\r\n++  ],\r\n++  items: [\r\n++    {\r\n++      id: 'sigil',\r\n++      name: 'metal sigil seal',\r\n++      takeable: true,\r\n++      description: 'A metal sigil that pulses whenever action animations trigger.',\r\n++      use: (state, engine) => {\r\n++        engine.printLine('The sigil resonates with your command flow.');\r\n++        return true;\r\n++      }\r\n++    }\r\n++  ]\r\n++};\r\n+ \r\n+EOF\r\n+)\n\\ No newline at end of file\n"
                },
                {
                    "date": 1772084781846,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n- (cd \"$(git rev-parse --show-toplevel)\" && git apply --3way <<'EOF' \r\n+(cd \"$(git rev-parse --show-toplevel)\" && git apply --3way <<'EOF' \r\n diff --git a/node_modules/lorejs/games/lemegeton.js b/node_modules/lorejs/games/lemegeton.js\r\n index fe3b5a0a2991aa6b3a2e25fb2c6e5d05776b11cf..eb28f82210bda0a35415dcf506f6d6aa73bd050e 100644\r\n --- a/node_modules/lorejs/games/lemegeton.js\r\n +++ b/node_modules/lorejs/games/lemegeton.js\r\n"
                },
                {
                    "date": 1772084899719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,238 +0,0 @@\n-(cd \"$(git rev-parse --show-toplevel)\" && git apply --3way <<'EOF' \r\n-diff --git a/node_modules/lorejs/games/lemegeton.js b/node_modules/lorejs/games/lemegeton.js\r\n-index fe3b5a0a2991aa6b3a2e25fb2c6e5d05776b11cf..eb28f82210bda0a35415dcf506f6d6aa73bd050e 100644\r\n---- a/node_modules/lorejs/games/lemegeton.js\r\n-+++ b/node_modules/lorejs/games/lemegeton.js\r\n-@@ -1,36 +1,194 @@\r\n--let state = {\r\n--    day: 1,\r\n--    weekday: \"saturn\",\r\n--    hour: \"saturn\"\r\n--};\r\n-+const IDLE_ANIMATIONS = [\r\n-+  [\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\   \\ \r\n-+      ''  ''`,\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\   \\ \r\n-+      ''  ''`,\r\n-+    String.raw`   .-.\r\n-+  (o o)\r\n-+  | O \\\r\n-+   \\   \\\r\n-+    \\\\   \\ \r\n-+     \\\\  / \r\n-+      ''  ''`\r\n-+  ],\r\n-+  [\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ (    ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`,\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ ( .. ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`,\r\n-+    String.raw` ~~~~~~~~\r\n-+~  .--.  ~\r\n-+~ ( oo ) ~\r\n-+~  '--'  ~\r\n-+ ~~~~~~~~`\r\n-+  ]\r\n-+];\r\n- \r\n--module.exports = {\r\n--    title: \"Lemegeton: The Journey to Apotheosis\",\r\n--    startRoom: \"cottage\",\r\n--    rooms: [\r\n--        {\r\n--            id: \"cottage\",\r\n--            name: \"Your Mother's Cottage\",\r\n--            description: \"Your mother's cottage is quite cozy.\",\r\n--            exits: {\r\n--                garden: \"garden\"\r\n--            },\r\n--            characters: [\"mother\"]\r\n--        },\r\n--        {\r\n--            id: \"garden\",\r\n--            name: \"The Garden\",\r\n--            description: \"A garden near mother's cottage, smells like flowers and berries.\"\r\n--        }\r\n--    ],\r\n--    characters: [\r\n--        {\r\n--            id: \"mother\",\r\n--            name: \"Loving Mother\",\r\n--            description: \"A kind and religious woman who cares deeply for her twins, Deo and Dominique.\",\r\n--            talk: (state, engine) => {\r\n--                engine.printLine(\"Mother: 'Be careful in the garden, children. Stay where I can see you.'\");\r\n--            }\r\n-+const ACTION_ANIMATIONS = [\r\n-+  [\r\n-+    String.raw`  /\\\r\n-+ /  \\\\\r\n-+| !! |\r\n-+ \\  /\r\n-+  \\/`,\r\n-+    String.raw`  /\\\\\r\n-+ / !!\\\\\r\n-+| !!!!|\r\n-+ \\ !!/\r\n-+  \\\\/`,\r\n-+    String.raw`  /\\\r\n-+ / **\\\\\r\n-+| ****|\r\n-+ \\ **/\r\n-+  \\/`\r\n-+  ],\r\n-+  [\r\n-+    String.raw`[>      ]`,\r\n-+    String.raw`[>>     ]`,\r\n-+    String.raw`[ >>>   ]`,\r\n-+    String.raw`[  >>>> ]`\r\n-+  ]\r\n-+];\r\n-+\r\n-+function createCommandAnimationTemplate({\r\n-+  idleAnimations,\r\n-+  actionAnimations,\r\n-+  excludedCommands = ['look'],\r\n-+  actionCommands = ['go', 'move', 'take', 'drop', 'use', 'talk', 'say', 'north', 'south', 'east', 'west', 'n', 's', 'e', 'w']\r\n-+}) {\r\n-+  const excluded = new Set(excludedCommands.map((cmd) => cmd.toLowerCase()));\r\n-+  const action = new Set(actionCommands.map((cmd) => cmd.toLowerCase()));\r\n-+\r\n-+  function initAnimationState(engine) {\r\n-+    if (!engine.state.variables.__animationTemplate) {\r\n-+      engine.state.variables.__animationTemplate = {\r\n-+        idleIndex: 0,\r\n-+        actionIndex: 0\r\n-+      };\r\n-+    }\r\n-+    return engine.state.variables.__animationTemplate;\r\n-+  }\r\n-+\r\n-+  function getMode(commandName) {\r\n-+    return action.has(commandName) ? 'action' : 'idle';\r\n-+  }\r\n-+\r\n-+  function nextAnimation(engine, mode) {\r\n-+    const templateState = initAnimationState(engine);\r\n-+    if (mode === 'action') {\r\n-+      const frame = actionAnimations[templateState.actionIndex % actionAnimations.length];\r\n-+      templateState.actionIndex += 1;\r\n-+      return frame;\r\n-+    }\r\n-+\r\n-+    const frame = idleAnimations[templateState.idleIndex % idleAnimations.length];\r\n-+    templateState.idleIndex += 1;\r\n-+    return frame;\r\n-+  }\r\n-+\r\n-+  function play(engine, commandName) {\r\n-+    if (excluded.has(commandName)) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    const mode = getMode(commandName);\r\n-+    const animationFrames = nextAnimation(engine, mode);\r\n-+\r\n-+    if (!animationFrames || !animationFrames.length) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    engine.stopAllAnimations();\r\n-+    engine.printImg(animationFrames);\r\n-+    engine.printLine(`{{cyan}}[${mode.toUpperCase()} ANIMATION]{{color_reset}}`, true);\r\n-+  }\r\n-+\r\n-+  function install(engine) {\r\n-+    if (engine.state.flags.commandAnimationTemplateInstalled) {\r\n-+      return;\r\n-+    }\r\n-+\r\n-+    for (const [commandName, commandConfig] of engine.world.commands) {\r\n-+      const originalFn = commandConfig.fn;\r\n-+      engine.world.commands.set(commandName, {\r\n-+        ...commandConfig,\r\n-+        fn(args, activeEngine) {\r\n-+          const result = originalFn.call(this, args, activeEngine);\r\n-+          play(activeEngine, commandName);\r\n-+          return result;\r\n-         }\r\n--    ]\r\n--}\r\n-\\ No newline at end of file\r\n-+      });\r\n-+    }\r\n-+\r\n-+    engine.state.flags.commandAnimationTemplateInstalled = true;\r\n-+  }\r\n-+\r\n-+  return {\r\n-+    install,\r\n-+    play,\r\n-+    nextAnimation,\r\n-+    getMode\r\n-+  };\r\n-+}\r\n-+\r\n-+const commandAnimationTemplate = createCommandAnimationTemplate({\r\n-+  idleAnimations: IDLE_ANIMATIONS,\r\n-+  actionAnimations: ACTION_ANIMATIONS,\r\n-+  excludedCommands: ['look']\r\n-+});\r\n-+\r\n-+module.exports = {\r\n-+  title: 'Lemegeton: Animation Template Demo',\r\n-+  startRoom: 'atrium',\r\n-+  rooms: [\r\n-+    {\r\n-+      id: 'atrium',\r\n-+      name: '{{bold}}Atrium{{font_reset}}',\r\n-+      description: 'A ritual atrium filled with humming glyphs. Try commands like {{yellow}}help{{color_reset}}, {{yellow}}go north{{color_reset}}, {{yellow}}take sigil{{color_reset}}, and {{yellow}}look{{color_reset}} to preview the animation template behavior.',\r\n-+      exits: {\r\n-+        north: 'sanctum'\r\n-+      },\r\n-+      items: ['sigil'],\r\n-+      onEnter: (state, engine) => {\r\n-+        commandAnimationTemplate.install(engine);\r\n-+      }\r\n-+    },\r\n-+    {\r\n-+      id: 'sanctum',\r\n-+      name: '{{bold}}Sanctum{{font_reset}}',\r\n-+      description: 'A quiet sanctum where idle effects continue between actions.',\r\n-+      exits: {\r\n-+        south: 'atrium'\r\n-+      }\r\n-+    }\r\n-+  ],\r\n-+  items: [\r\n-+    {\r\n-+      id: 'sigil',\r\n-+      name: 'metal sigil seal',\r\n-+      takeable: true,\r\n-+      description: 'A metal sigil that pulses whenever action animations trigger.',\r\n-+      use: (state, engine) => {\r\n-+        engine.printLine('The sigil resonates with your command flow.');\r\n-+        return true;\r\n-+      }\r\n-+    }\r\n-+  ]\r\n-+};\r\n- \r\n-EOF\r\n-)\n\\ No newline at end of file\n"
                },
                {
                    "date": 1772084908119,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,4 +231,5 @@\n +      }\r\n +    }\r\n +  ]\r\n +};\r\n+\r\n"
                }
            ],
            "date": 1772084580166,
            "name": "Commit-0",
            "content": "diff --git a/node_modules/lorejs/games/lemegeton.js b/node_modules/lorejs/games/lemegeton.js\r\nindex fe3b5a0a2991aa6b3a2e25fb2c6e5d05776b11cf..eb28f82210bda0a35415dcf506f6d6aa73bd050e 100644\r\n--- a/node_modules/lorejs/games/lemegeton.js\r\n+++ b/node_modules/lorejs/games/lemegeton.js\r\n@@ -1,36 +1,194 @@\r\n-let state = {\r\n-    day: 1,\r\n-    weekday: \"saturn\",\r\n-    hour: \"saturn\"\r\n-};\r\n+const IDLE_ANIMATIONS = [\r\n+  [\r\n+    String.raw`   .-.\r\n+  (o o)\r\n+  | O \\\r\n+   \\   \\\r\n+    \\\\   \\ \r\n+     \\\\   \\ \r\n+      ''  ''`,\r\n+    String.raw`   .-.\r\n+  (o o)\r\n+  | O \\\r\n+   \\   \\\r\n+    \\\\   \\ \r\n+     \\\\   \\ \r\n+      ''  ''`,\r\n+    String.raw`   .-.\r\n+  (o o)\r\n+  | O \\\r\n+   \\   \\\r\n+    \\\\   \\ \r\n+     \\\\  / \r\n+      ''  ''`\r\n+  ],\r\n+  [\r\n+    String.raw` ~~~~~~~~\r\n+~  .--.  ~\r\n+~ (    ) ~\r\n+~  '--'  ~\r\n+ ~~~~~~~~`,\r\n+    String.raw` ~~~~~~~~\r\n+~  .--.  ~\r\n+~ ( .. ) ~\r\n+~  '--'  ~\r\n+ ~~~~~~~~`,\r\n+    String.raw` ~~~~~~~~\r\n+~  .--.  ~\r\n+~ ( oo ) ~\r\n+~  '--'  ~\r\n+ ~~~~~~~~`\r\n+  ]\r\n+];\r\n \r\n-module.exports = {\r\n-    title: \"Lemegeton: The Journey to Apotheosis\",\r\n-    startRoom: \"cottage\",\r\n-    rooms: [\r\n-        {\r\n-            id: \"cottage\",\r\n-            name: \"Your Mother's Cottage\",\r\n-            description: \"Your mother's cottage is quite cozy.\",\r\n-            exits: {\r\n-                garden: \"garden\"\r\n-            },\r\n-            characters: [\"mother\"]\r\n-        },\r\n-        {\r\n-            id: \"garden\",\r\n-            name: \"The Garden\",\r\n-            description: \"A garden near mother's cottage, smells like flowers and berries.\"\r\n-        }\r\n-    ],\r\n-    characters: [\r\n-        {\r\n-            id: \"mother\",\r\n-            name: \"Loving Mother\",\r\n-            description: \"A kind and religious woman who cares deeply for her twins, Deo and Dominique.\",\r\n-            talk: (state, engine) => {\r\n-                engine.printLine(\"Mother: 'Be careful in the garden, children. Stay where I can see you.'\");\r\n-            }\r\n+const ACTION_ANIMATIONS = [\r\n+  [\r\n+    String.raw`  /\\\r\n+ /  \\\\\r\n+| !! |\r\n+ \\  /\r\n+  \\/`,\r\n+    String.raw`  /\\\\\r\n+ / !!\\\\\r\n+| !!!!|\r\n+ \\ !!/\r\n+  \\\\/`,\r\n+    String.raw`  /\\\r\n+ / **\\\\\r\n+| ****|\r\n+ \\ **/\r\n+  \\/`\r\n+  ],\r\n+  [\r\n+    String.raw`[>      ]`,\r\n+    String.raw`[>>     ]`,\r\n+    String.raw`[ >>>   ]`,\r\n+    String.raw`[  >>>> ]`\r\n+  ]\r\n+];\r\n+\r\n+function createCommandAnimationTemplate({\r\n+  idleAnimations,\r\n+  actionAnimations,\r\n+  excludedCommands = ['look'],\r\n+  actionCommands = ['go', 'move', 'take', 'drop', 'use', 'talk', 'say', 'north', 'south', 'east', 'west', 'n', 's', 'e', 'w']\r\n+}) {\r\n+  const excluded = new Set(excludedCommands.map((cmd) => cmd.toLowerCase()));\r\n+  const action = new Set(actionCommands.map((cmd) => cmd.toLowerCase()));\r\n+\r\n+  function initAnimationState(engine) {\r\n+    if (!engine.state.variables.__animationTemplate) {\r\n+      engine.state.variables.__animationTemplate = {\r\n+        idleIndex: 0,\r\n+        actionIndex: 0\r\n+      };\r\n+    }\r\n+    return engine.state.variables.__animationTemplate;\r\n+  }\r\n+\r\n+  function getMode(commandName) {\r\n+    return action.has(commandName) ? 'action' : 'idle';\r\n+  }\r\n+\r\n+  function nextAnimation(engine, mode) {\r\n+    const templateState = initAnimationState(engine);\r\n+    if (mode === 'action') {\r\n+      const frame = actionAnimations[templateState.actionIndex % actionAnimations.length];\r\n+      templateState.actionIndex += 1;\r\n+      return frame;\r\n+    }\r\n+\r\n+    const frame = idleAnimations[templateState.idleIndex % idleAnimations.length];\r\n+    templateState.idleIndex += 1;\r\n+    return frame;\r\n+  }\r\n+\r\n+  function play(engine, commandName) {\r\n+    if (excluded.has(commandName)) {\r\n+      return;\r\n+    }\r\n+\r\n+    const mode = getMode(commandName);\r\n+    const animationFrames = nextAnimation(engine, mode);\r\n+\r\n+    if (!animationFrames || !animationFrames.length) {\r\n+      return;\r\n+    }\r\n+\r\n+    engine.stopAllAnimations();\r\n+    engine.printImg(animationFrames);\r\n+    engine.printLine(`{{cyan}}[${mode.toUpperCase()} ANIMATION]{{color_reset}}`, true);\r\n+  }\r\n+\r\n+  function install(engine) {\r\n+    if (engine.state.flags.commandAnimationTemplateInstalled) {\r\n+      return;\r\n+    }\r\n+\r\n+    for (const [commandName, commandConfig] of engine.world.commands) {\r\n+      const originalFn = commandConfig.fn;\r\n+      engine.world.commands.set(commandName, {\r\n+        ...commandConfig,\r\n+        fn(args, activeEngine) {\r\n+          const result = originalFn.call(this, args, activeEngine);\r\n+          play(activeEngine, commandName);\r\n+          return result;\r\n         }\r\n-    ]\r\n-}\r\n\\ No newline at end of file\r\n+      });\r\n+    }\r\n+\r\n+    engine.state.flags.commandAnimationTemplateInstalled = true;\r\n+  }\r\n+\r\n+  return {\r\n+    install,\r\n+    play,\r\n+    nextAnimation,\r\n+    getMode\r\n+  };\r\n+}\r\n+\r\n+const commandAnimationTemplate = createCommandAnimationTemplate({\r\n+  idleAnimations: IDLE_ANIMATIONS,\r\n+  actionAnimations: ACTION_ANIMATIONS,\r\n+  excludedCommands: ['look']\r\n+});\r\n+\r\n+module.exports = {\r\n+  title: 'Lemegeton: Animation Template Demo',\r\n+  startRoom: 'atrium',\r\n+  rooms: [\r\n+    {\r\n+      id: 'atrium',\r\n+      name: '{{bold}}Atrium{{font_reset}}',\r\n+      description: 'A ritual atrium filled with humming glyphs. Try commands like {{yellow}}help{{color_reset}}, {{yellow}}go north{{color_reset}}, {{yellow}}take sigil{{color_reset}}, and {{yellow}}look{{color_reset}} to preview the animation template behavior.',\r\n+      exits: {\r\n+        north: 'sanctum'\r\n+      },\r\n+      items: ['sigil'],\r\n+      onEnter: (state, engine) => {\r\n+        commandAnimationTemplate.install(engine);\r\n+      }\r\n+    },\r\n+    {\r\n+      id: 'sanctum',\r\n+      name: '{{bold}}Sanctum{{font_reset}}',\r\n+      description: 'A quiet sanctum where idle effects continue between actions.',\r\n+      exits: {\r\n+        south: 'atrium'\r\n+      }\r\n+    }\r\n+  ],\r\n+  items: [\r\n+    {\r\n+      id: 'sigil',\r\n+      name: 'metal sigil seal',\r\n+      takeable: true,\r\n+      description: 'A metal sigil that pulses whenever action animations trigger.',\r\n+      use: (state, engine) => {\r\n+        engine.printLine('The sigil resonates with your command flow.');\r\n+        return true;\r\n+      }\r\n+    }\r\n+  ]\r\n+};\r\n"
        }
    ]
}