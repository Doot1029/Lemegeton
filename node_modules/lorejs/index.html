<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lemegeton</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-1: #2a0b3d;
      --bg-2: #190026;
      --crt-glow: #a05cff;
      --crt-shadow: #0b0012;
      --panel-bg: rgba(18, 6, 32, 0.85);
      --panel-border: #b27aff;
      --panel-text: #f2e9ff;
      --panel-muted: #c6a8ff;
      --terminal-text: #eae4ff;
      --terminal-prompt: #b983ff;
      --terminal-input: #f8eaff;
      --scanline: rgba(255, 255, 255, 0.04);
      --grid: rgba(168, 105, 255, 0.12);
      --accent: #d4b0ff;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "VT323", "Press Start 2P", monospace;
      background: radial-gradient(circle at top, var(--bg-1), var(--bg-2));
      color: var(--panel-text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 32px;
    }

    .crt-frame {
      width: min(1400px, 96vw);
      height: min(820px, 90vh);
      border-radius: 24px;
      background: linear-gradient(160deg, #2c0f41, #12001f);
      box-shadow:
        0 0 0 4px #1a0528,
        0 0 25px rgba(160, 92, 255, 0.5),
        0 40px 120px rgba(5, 0, 10, 0.8);
      padding: 24px;
      position: relative;
    }

    .crt-screen {
      height: 100%;
      border-radius: 18px;
      background:
        radial-gradient(circle at 20% 20%, rgba(160, 92, 255, 0.2), transparent 55%),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(180deg, rgba(255, 255, 255, 0.025) 1px, transparent 1px),
        var(--panel-bg);
      background-size: 26px 26px, 40px 40px, 40px 40px, auto;
      border: 2px solid var(--panel-border);
      box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.6);
      overflow: hidden;
      position: relative;
      padding: 18px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .crt-screen::before,
    .crt-screen::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .crt-screen::before {
      background: repeating-linear-gradient(
        180deg,
        var(--scanline),
        var(--scanline) 1px,
        transparent 2px,
        transparent 4px
      );
      mix-blend-mode: screen;
      opacity: 0.6;
    }

    .crt-screen::after {
      background: radial-gradient(circle at 50% 50%, transparent 30%, rgba(0, 0, 0, 0.55) 100%);
      mix-blend-mode: multiply;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-family: "Press Start 2P", monospace;
      font-size: 12px;
      color: var(--accent);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 2.4fr) minmax(240px, 1fr);
      gap: 16px;
      flex: 1;
      position: relative;
      z-index: 1;
    }

    .terminal-shell {
      border: 2px solid var(--panel-border);
      border-radius: 16px;
      padding: 12px;
      background: rgba(10, 0, 18, 0.75);
      box-shadow: inset 0 0 24px rgba(160, 92, 255, 0.18);
      position: relative;
      overflow: hidden;
    }

    .terminal-shell::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 16px;
      box-shadow: inset 0 0 40px rgba(160, 92, 255, 0.4);
      pointer-events: none;
    }

    #terminalHost {
      height: 100%;
      min-height: 420px;
      position: relative;
    }

    .lore-terminal {
      position: relative !important;
      inset: auto !important;
      width: 100% !important;
      height: 100% !important;
      border: none !important;
      box-shadow: none !important;
      padding: 16px !important;
      display: flex !important;
      flex-direction: column !important;
    }

    .lore-output {
      flex: 1 1 auto !important;
      height: auto !important;
      overflow-y: auto !important;
    }

    .panel {
      border: 2px solid var(--panel-border);
      border-radius: 16px;
      padding: 16px;
      background: rgba(16, 3, 26, 0.9);
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-height: 0;
    }

    .panel h2 {
      font-family: "Press Start 2P", monospace;
      font-size: 12px;
      margin: 0;
      color: var(--accent);
    }

    .panel-scroll {
      overflow-y: auto;
      padding-right: 6px;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .panel-scroll::-webkit-scrollbar {
      width: 8px;
    }

    .panel-scroll::-webkit-scrollbar-thumb {
      background: rgba(178, 122, 255, 0.6);
      border-radius: 6px;
    }

    .panel-section {
      border: 1px solid rgba(178, 122, 255, 0.4);
      border-radius: 12px;
      padding: 10px;
      background: rgba(8, 0, 15, 0.6);
    }

    .panel-section h3 {
      margin: 0 0 8px;
      font-size: 12px;
      color: var(--panel-muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .panel-section ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 6px;
      font-size: 16px;
    }

    .panel-section li {
      display: flex;
      justify-content: space-between;
      color: var(--panel-text);
    }

    .panel-section span {
      color: var(--panel-muted);
    }

    .status-strip {
      font-size: 14px;
      color: var(--panel-muted);
      display: flex;
      justify-content: space-between;
      gap: 12px;
    }

    @media (max-width: 980px) {
      body {
        padding: 16px;
      }

      .layout {
        grid-template-columns: 1fr;
      }

      .panel {
        min-height: 260px;
      }
    }
  </style>
</head>
<body>
  <div class="crt-frame">
    <div class="crt-screen">
      <div class="top-bar">
        <div>LEMEGETON CRT TERMINAL</div>
        <div>ZENITH RANK PROTOCOL</div>
      </div>

      <div class="layout">
        <div class="terminal-shell">
          <div id="terminalHost" aria-live="polite"></div>
        </div>

        <aside class="panel">
          <h2>Mission Panels</h2>
          <div class="panel-scroll">
            <div class="panel-section">
              <h3>Core Systems</h3>
              <ul>
                <li>Sanity <span>Stable</span></li>
                <li>Wrath <span>Contained</span></li>
                <li>Loyalty <span>Growing</span></li>
                <li>Rank <span>Novice</span></li>
              </ul>
            </div>
            <div class="panel-section">
              <h3>Relics</h3>
              <ul>
                <li>Ring of Solomonis <span>Locked</span></li>
                <li>Metal Sigil Seal <span>Unknown</span></li>
                <li>Kamea Tablet <span>Missing</span></li>
                <li>Chaldean Clock <span>Offline</span></li>
              </ul>
            </div>
            <div class="panel-section">
              <h3>Infernal Atlas</h3>
              <ul>
                <li>City of Dis <span>Scouted</span></li>
                <li>Sigilway <span>Restricted</span></li>
                <li>Inferno Academy <span>Pending</span></li>
                <li>Shadowbrook Woods <span>Unmapped</span></li>
              </ul>
            </div>
            <div class="panel-section">
              <h3>Celestial Atlas</h3>
              <ul>
                <li>Aethel City <span>Observed</span></li>
                <li>Celestia Academy <span>Sealed</span></li>
                <li>Celestial Grove <span>Hidden</span></li>
                <li>Aethelway <span>Guarded</span></li>
              </ul>
            </div>
            <div class="panel-section">
              <h3>Contacts</h3>
              <ul>
                <li>Desdemona <span>Active</span></li>
                <li>Deo <span>Searching</span></li>
                <li>Solomonis <span>Masked</span></li>
                <li>Sith <span>Unknown</span></li>
              </ul>
            </div>
          </div>
          <div class="status-strip">
            <div>Signal: Stable</div>
            <div>Mode: Singleplayer</div>
          </div>
        </aside>
      </div>
    </div>
  </div>

  <script src="lore.js"></script>
  <script src="games/lemegeton.js"></script>
  <script src="/socket.js"></script>
  <script>
    const game = new LORE.Game({
      prompt: "{{magenta}}»{{color_reset}} ",
      typingSpeed: 20,
      autosave: false
    });

    game.loadTheme({
      "--lore-bg-color": "#12001f",
      "--lore-text-color": "#eae4ff",
      "--lore-prompt-color": "#b983ff",
      "--lore-input-color": "#f8eaff",
      "--lore-font-family": "VT323, monospace",
      "--lore-font-size": "18px",
      "--lore-border-color": "#b27aff",
      "--lore-prompt-content": "{{magenta}}»{{color_reset}} "
    });

    game.loadNovel(window.LEMEGETON);

    const host = document.getElementById("terminalHost");
    const terminal = document.querySelector(".lore-terminal");
    const panelScroll = document.querySelector(".panel-scroll");

    const applyBodyPadding = () => {
      const basePadding = window.innerWidth < 980 ? "16px" : "32px";
      document.body.style.padding = basePadding;
    };

    applyBodyPadding();
    window.addEventListener("resize", applyBodyPadding);

    if (terminal && host) {
      terminal.style.position = "relative";
      terminal.style.top = "auto";
      terminal.style.left = "auto";
      terminal.style.width = "100%";
      terminal.style.height = "100%";
      terminal.style.border = "none";
      terminal.style.padding = "16px";
      terminal.style.boxShadow = "none";
      host.appendChild(terminal);
    }

    if (panelScroll) {
      panelScroll.scrollTop = 0;
    }
  </script>
</body>
</html>
